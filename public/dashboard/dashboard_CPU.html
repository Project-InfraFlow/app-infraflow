<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfraFlow - Sistema de Monitoramento</title>
    <link rel="stylesheet" href="../css/cpu.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="../assets/imgs/estrada.png">
</head>

<body>

    <div id="dashboard" class="dashboard">
        <aside class="sidebar">

            <nav class="nav">
                <button class="nav-item" data-view="overview" id="btnPainel">
                    <i class="fas fa-gauge"></i>
                    <span>Painel</span>
                </button>

                <button data-view="monitor" class="nav-item">
                    <i class="fas fa-chart-line"></i>
                    <span>Monitoramento</span>
                </button>

                <button data-view="cadastro" class="nav-item">
                    <i class="fas fa-pen-to-square"></i>
                    <span>Cadastro</span>
                </button>
                <button data-view="historico" class="nav-item">
                    <i class="fas fa-clock-rotate-left"></i>
                    <span>Histórico de Alertas</span>
                </button>
                                <button class="nav-item active" data-view="overview" onclick="window.location.href='dashboard_CPU.html'">
                    <i class="fas fa-gauge"></i>
                    <span>Painel CPU</span>
                </button>
            </nav>

            <div class="divider"></div>

            <div class="user-section">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="sidebarUser">Admin</span>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </aside>

        <main class="content">
            <header class="topbar">
                <div class="brand">
                    <a href="dashboard.html" title="Voltar para o painel principal">
                        <img src="../assets/infra-parafundobranco.png" alt="InfraFlow">
                    </a>
                </div>
                <div class="topbar-left">
                    <div class="machine-select">
                        <i class="fas fa-server"></i>
                        <label for="edgeSelector"
                            style="display:block; font-size:14px; margin-bottom:4px; color: gray;">
                            Selecione um pórtico FreeFlow:
                        </label>
                        <select id="edgeSelector">
                            <option value="INFRA-EDGE-01-Itápolis (SP-333)">INFRA-EDGE-01-Itápolis (SP-333)</option>
                            <option value="INFRA-EDGE-02-Jaboticabal (SP-333)">INFRA-EDGE-02-Jaboticabal (SP-333)
                            </option>
                            <option value="INFRA-EDGE-03-São José dos Campos (SP-099)">INFRA-EDGE-03-São José dos Campos
                                (SP-099)
                            </option>
                            <option value="INFRA-EDGE-04-Itaguaí (Km 414)">INFRA-EDGE-04-Itaguaí (Km 414)</option>
                        </select>
                    </div>
                    <div class="os-info">
                        <i class="fab fa-ubuntu"></i>
                        <span>Ubuntu 22.04 LTS</span>
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span>Online</span>
                    </div>
                    <div class="last-update">
                        <span class="update-label">Última atualização:</span>
                        <span class="update-time" id="lastUpdateTime">--:--:--</span>
                    </div>
                </div>
            </header>

            <section id="view-overview" class="view active">
                <div class="view-header">
                    <h1 class="view-title">
                        <i class="fas fa-microchip"></i>
                        CPU <span id="monitor-selecionado"></span>

                        <span class="slack-icon" id="btnSlack">
                            <img src="../assets/icon/Slack_icon.png">
                        </span>
                    </h1>
                </div>

                <div class="kpis-grid">

                    <div class="kpi-card" id="kpiCpu">
                        <div class="kpi-header">
                            <div class="kpi-icon cpu">
                                <i class="fas fa-microchip"></i>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Utilização por núcleo</span>
                            </div>
                        </div>
                        <div class="kpi-value" id="kpiCpuValue">80%</div>
                        <div class="kpi-progress">
                            <div class="progress-bar cpu" id="cpuProgress"></div>
                        </div>
                    </div>

                    <div class="kpi-card" id="KpiProcessos">
                        <div class="kpi-header">
                            <div class="kpi-icon processos">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Processos em execução</span>
                            </div>
                        </div>
                        <div class="kpi-value" id="KpiProcessosValue">213</div>
                        <div class="kpi-progress">
                            <div class="progress-bar processos" id="processosProgress"></div>
                        </div>
                    </div>

                    <div class="kpi-card" id="KpiTempo">
                        <div class="kpi-header">
                            <div class="kpi-icon tempo">
                                <i class="fas fa-stopwatch"></i>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Tempo Ocioso</span>
                            </div>
                        </div>
                        <div class="kpi-value" id="KpiTempoValue">21%</div>
                        <div class="kpi-progress">
                            <div class="progress-bar tempo" id="tempoProgress"></div>
                        </div>
                    </div>

                    <div class="kpi-card" id="kpiRede">
                        <div class="kpi-header">
                            <div class="kpi-icon rede">
                                <i class="fas fa-triangle-exclamation"></i>
                            </div>
                            <div class="kpi-info">
                                <span class="kpi-label">Total de alertas CPU</span>
                            </div>
                        </div>
                        <div class="kpi-value" id="kpiRedeValue">8</div>
                        <div class="kpi-progress">
                            <div class="progress-bar rede" id="redeProgress"></div>
                        </div>
                    </div>

                </div>

                <div class="charts-grid">

                    <div class="chart-container">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-chart-line"></i>
                                CPU x Tempo ocioso
                            </h3>

                            <div class="kpi-info-icon">
                                <i class="fas fa-info-circle"></i>

                                <div class="parametro">
                                    <strong>Parâmetros CPU:</strong><br>
                                    • 20% – 45% → Saudável<br>
                                    • 45% – 85% → Monitorar<br>
                                    • > 85% → Crítico<br><br>

                                    <strong>Parâmetros Idle:</strong><br>
                                    • 70% – 100% → Saudável <br>
                                    • 30% – 70% → Monitorar <br>
                                    • 0% – 30% → Crítico
                                </div>
                            </div>
                        </div>

                        <div class="chart-content">
                            <canvas id="cpuLatenciaChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-header">
                            <h3 class="chart-title">
                                <i class="fas fa-microchip"></i>
                                Processos em Execução
                            </h3>

                            <div class="kpi-info-icon">
                                <i class="fas fa-info-circle"></i>

                                <div class="parametro">
                                    <strong>Parâmetros Processos:</strong><br>
                                    • 0 – 250 → Saudável <br>
                                    • 250 – 400 → Monitorar <br>
                                    • > 400 → Crítico <br>
                                </div>
                            </div>
                        </div>

                        <div class="chart-content">
                            <canvas id="processosChart"></canvas>
                        </div>
                    </div>

                </div>

            </section>

            <div class="slack-painel" id="slackpainel">
                <div class="slack-painel-header">
                    <h4>Alertas Ativos da CPU</h4>
                    <button id="closeSlack" class="close-slack">×</button>
                </div>

                <div class="slack-painel-body">
                    <p>Carregando alertas CPU...</p>
                </div>
            </div>

        </main>
    </div>

    <script src="../js/exemplo.js"></script>
    <script src="../js/cpuDashboard.js"></script>

    <script>
        document.getElementById("logoutBtn").addEventListener("click", function () {
            window.location.href = "login.html";
        });

        const select = document.getElementById("edgeSelector");
        const spanMonitor = document.getElementById("monitor-selecionado");

        function atualizarMonitor() {
            spanMonitor.textContent = `– ${select.value}`;
        }

        select.addEventListener("change", atualizarMonitor);
        atualizarMonitor();

        const slackBtn = document.getElementById("btnSlack");
        const slackpainel = document.getElementById("slackpainel");
        const closeSlack = document.getElementById("closeSlack");

        slackBtn.addEventListener("click", () => {
            slackpainel.classList.add("open");
            document.body.classList.add("slack-open");
        });

        closeSlack.addEventListener("click", () => {
            slackpainel.classList.remove("open");
            document.body.classList.remove("slack-open");
        });

        document.getElementById('btnPainel').addEventListener('click', function () {
            window.location.href = 'dashboard.html';
        });

    </script>

</body>

</html>